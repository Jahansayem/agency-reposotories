â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    FULL UPGRADE DEPLOYMENT CHECKLIST
    OAuth + Schema Migration
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ Step 1: Get Google OAuth Credentials
  â–¡ Go to console.cloud.google.com
  â–¡ Create/select project
  â–¡ Enable Google+ API
  â–¡ Create OAuth 2.0 Client ID
  â–¡ Add redirect URIs:
    - https://shared-todo-list-production.up.railway.app/api/auth/callback/google
    - http://localhost:3000/api/auth/callback/google
  â–¡ Copy Client ID
  â–¡ Copy Client Secret

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ Step 2: Run Database Migrations
  â–¡ Open Supabase Dashboard â†’ SQL Editor
  â–¡ Run Migration 1 (OAuth):
    - Copy: supabase/migrations/20260108_oauth_support.sql
    - Paste in SQL Editor
    - Click "Run"
    - âœ“ Check for success message

  â–¡ Run Migration 2 (Normalized Schema):
    - Copy: supabase/migrations/20260108_normalized_schema.sql
    - Paste in SQL Editor
    - Click "Run"
    - âœ“ Check for success message

  â–¡ Verify new tables exist:
    - subtasks_v2
    - attachments_v2
    - user_assignments
    - accounts, sessions, verification_tokens

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ Step 3: Add Environment Variables to Railway
  â–¡ Go to Railway project â†’ Variables
  â–¡ Add: NEXTAUTH_URL=https://shared-todo-list-production.up.railway.app
  â–¡ Add: NEXTAUTH_SECRET=b9/NQvFL82eCNFmwc75pVm2oqAhosIoSCmaA+pcxaDM=
  â–¡ Add: GOOGLE_CLIENT_ID=<from Step 1>
  â–¡ Add: GOOGLE_CLIENT_SECRET=<from Step 1>
  â–¡ Add: NEXT_PUBLIC_USE_OAUTH=true
  â–¡ Add: NEXT_PUBLIC_USE_NORMALIZED_SCHEMA=false
  â–¡ Save changes

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ Step 4: Deploy to Railway
  â–¡ git add -A
  â–¡ git commit -m "feat: Enable OAuth and schema migration"
  â–¡ git push origin refactor/security-and-architecture
  â–¡ Wait for Railway deployment to complete
  â–¡ Check deployment logs for errors

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ Step 5: Test OAuth Login
  â–¡ Visit: https://shared-todo-list-production.up.railway.app
  â–¡ Verify "Sign in with Google" button appears
  â–¡ Click "Sign in with Google"
  â–¡ Select Google account
  â–¡ âœ“ Redirected back and logged in
  â–¡ Test PIN login (verify still works)
  â–¡ Test existing user login

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ Step 6: Run Schema Migration (Local)
  â–¡ Add to .env.local:
    - NEXT_PUBLIC_SUPABASE_URL=<your-url>
    - SUPABASE_SERVICE_ROLE_KEY=<your-key>

  â–¡ Dry run: npm run migrate:dry-run
  â–¡ Review output
  â–¡ Run migration: npm run migrate:schema
  â–¡ Wait for completion
  â–¡ âœ“ Check success message

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ Step 7: Verify Migration
  â–¡ npm run migrate:verify
  â–¡ âœ“ Check "VERIFICATION PASSED"
  â–¡ Review verified counts:
    - Subtasks verified: ___
    - Attachments verified: ___
    - Assignments verified: ___

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ Step 8: Enable Normalized Schema
  â–¡ Go to Railway â†’ Variables
  â–¡ Change: NEXT_PUBLIC_USE_NORMALIZED_SCHEMA=true
  â–¡ Save (Railway auto-redeploys)
  â–¡ Wait for deployment
  â–¡ Check logs for errors

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ Step 9: Monitor (1 Week)
  Day 1:
    â–¡ Check Railway logs
    â–¡ Test creating tasks
    â–¡ Test adding subtasks
    â–¡ Test uploading files

  Day 3:
    â–¡ Check Railway logs
    â–¡ Test all features

  Day 7:
    â–¡ Final check
    â–¡ All features working âœ“

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ Step 10: Clean Up (After 2-4 Weeks - Optional)
  â–¡ Confirm everything stable
  â–¡ Run in Supabase SQL Editor:
    ALTER TABLE todos DROP COLUMN subtasks;
    ALTER TABLE todos DROP COLUMN attachments;
  â–¡ âš ï¸ This is permanent - only do if confident!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    DEPLOYMENT COMPLETE! ğŸ‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Features enabled:
  âœ“ OAuth Login (Google + PIN)
  âœ“ Normalized Database Schema
  âœ“ Zero Downtime Migration

Cost: $0/month

Next: Check Railway dashboard and enjoy your upgraded app!
